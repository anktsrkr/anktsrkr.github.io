<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <script type="application/ld+json">

{  
  "@context":"http://schema.org",
  "@type":"Website",
  "@id":"https:\/\/anktsrkr.github.io\/",
  "author": {
    "@type": "Person",
    "name": "Ankit Sarkar | .NET Enthusiast | Azure Cloud Practitioner",
    
    "image": "https://www.gravatar.com/avatar/95b5dbc23a1aea8bc95d53efd0a30edf"
    
  },
  "name":"Ankit Sarkar | .NET Enthusiast | Azure Cloud Practitioner",
  "description":"Connect privately to a Azure PaaS resources using Azure Private Endpoint from on-prem",
  "url":"https:\/\/anktsrkr.github.io\/post\/connect-privately-to-azure-paas-resources-using-azure-private-endpoint\/",
  "keywords":"[hub, spoke,hub, spoke, network,hub, spoke, network, topology,azure, hub, spoke,azure, hub, spoke, network,azure, hub, spoke, network, topology, ,azure, private, dns, zone,, resolve, azure, internal, DNS, from, your, on, prem,hub, spoke, dns, forwarder,dns, forwarder, in, hub, spoke,dns, forwarder, in, hub, spoke, network, topology,dns, forwarder,azure, powershell,Point, to, Site,, Site, to, Site,VPN,Private, link,storage, account, over, private, ip, from, on, prem,Secure, azure, resources, using, Private, Link,Connect, privately, to, azure, storage, account,azure, private, link,azure, private, endpoint,private, endpoint,private, link,private, link, azure, storage,private, link, azure, blob,, azure, service, endpoint,service, endpoint,service, endpoint, vs, private, link,private, endpoint, azure, dns]"
}

</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.121.1 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="Ankit Sarkar | .NET Enthusiast | Azure Cloud Practitioner">
<meta name="keywords" content="hub, spoke,hub, spoke, network,hub, spoke, network, topology,azure, hub, spoke,azure, hub, spoke, network,azure, hub, spoke, network, topology, ,azure, private, dns, zone,, resolve, azure, internal, DNS, from, your, on, prem,hub, spoke, dns, forwarder,dns, forwarder, in, hub, spoke,dns, forwarder, in, hub, spoke, network, topology,dns, forwarder,azure, powershell,Point, to, Site,, Site, to, Site,VPN,Private, link,storage, account, over, private, ip, from, on, prem,Secure, azure, resources, using, Private, Link,Connect, privately, to, azure, storage, account,azure, private, link,azure, private, endpoint,private, endpoint,private, link,private, link, azure, storage,private, link, azure, blob,, azure, service, endpoint,service, endpoint,service, endpoint, vs, private, link,private, endpoint, azure, dns">
<meta name="description" content="Connect privately to a Azure PaaS resources using Azure Private Endpoint from on-prem">


<meta property="og:description" content="Connect privately to a Azure PaaS resources using Azure Private Endpoint from on-prem">
<meta property="og:type" content="article">
<meta property="og:title" content="Connect privately to Azure PaaS resources using Azure Private Endpoint from on-prem">
<meta name="twitter:title" content="Connect privately to Azure PaaS resources using Azure Private Endpoint from on-prem">
<meta property="og:url" content="https://anktsrkr.github.io/post/connect-privately-to-azure-paas-resources-using-azure-private-endpoint/">
<meta property="twitter:url" content="https://anktsrkr.github.io/post/connect-privately-to-azure-paas-resources-using-azure-private-endpoint/">
<meta property="og:site_name" content="Ankit Sarkar | .NET Enthusiast | Azure Cloud Practitioner">
<meta property="og:description" content="Connect privately to a Azure PaaS resources using Azure Private Endpoint from on-prem">
<meta name="twitter:description" content="Connect privately to a Azure PaaS resources using Azure Private Endpoint from on-prem">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2020-09-15T01:00:00">
  
  
    <meta property="article:modified_time" content="2020-09-15T01:00:00">
  
  
  
    
      <meta property="article:section" content="Hub-Spoke Topology">
    
  
  
    
      <meta property="article:tag" content="Azure">
    
      <meta property="article:tag" content="Networking">
    
      <meta property="article:tag" content="Azure Private DNS Zone">
    
      <meta property="article:tag" content="Azure Private link">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@anktsrkr">


  <meta name="twitter:creator" content="@anktsrkr">










  <meta property="og:image" content="https://anktsrkr.github.io/images/azure.png">
  <meta property="twitter:image" content="https://anktsrkr.github.io/images/azure.png">


  <meta property="og:image" content="https://www.gravatar.com/avatar/95b5dbc23a1aea8bc95d53efd0a30edf?s=640">
  <meta property="twitter:image" content="https://www.gravatar.com/avatar/95b5dbc23a1aea8bc95d53efd0a30edf?s=640">

    <title>Connect privately to Azure PaaS resources using Azure Private Endpoint from on-prem</title>

    <link rel="icon" href="https://anktsrkr.github.io/favicon.png">
    

    

    <link rel="canonical" href="https://anktsrkr.github.io/post/connect-privately-to-azure-paas-resources-using-azure-private-endpoint/">

    
    <link rel="preload"  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet"  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer"></noscript>
    
   
    <link rel="stylesheet" rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    
    
    <link rel="stylesheet" href="https://anktsrkr.github.io/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css"/>
    
    
    

    
<script>
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-176781214-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
    <link rel="manifest" href="https://anktsrkr.github.io/manifest.json">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2534759648571863"
     crossorigin="anonymous"></script>
<script id="usercentrics-cmp" src="https://app.usercentrics.eu/browser-ui/latest/loader.js" data-settings-id="9gZ8D7m_t9Y2oK" async></script>
     
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TY8ZMTBGSM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TY8ZMTBGSM');
</script>
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="5">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://anktsrkr.github.io/" aria-label="Go to homepage">Ankit Sarkar | .NET Enthusiast | Azure Cloud Practitioner</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://anktsrkr.github.io/#about" aria-label="Open the link: /#about">
    
    
    
      
        <img class="header-picture" src="https://www.gravatar.com/avatar/95b5dbc23a1aea8bc95d53efd0a30edf?s=90" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="5">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://anktsrkr.github.io/#about" aria-label="Read more about the author">
          <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/95b5dbc23a1aea8bc95d53efd0a30edf?s=110" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Ankit Sarkar | .NET Enthusiast | Azure Cloud Practitioner</h4>
        
          <h5 class="sidebar-profile-bio"><strong>Technical Architect, Microsoft Certified Azure Solutions Architect Expert</strong></h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://anktsrkr.github.io/" title="Home">
    
      <i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://anktsrkr.github.io/categories" title="Categories">
    
      <i class="sidebar-button-icon fas fa-lg fa-bookmark" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://anktsrkr.github.io/tags" title="Tags">
    
      <i class="sidebar-button-icon fas fa-lg fa-tags" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://anktsrkr.github.io/archives" title="Archives">
    
      <i class="sidebar-button-icon fas fa-lg fa-archive" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://anktsrkr.github.io/about" title="About">
    
      <i class="sidebar-button-icon fas fa-lg fa-question" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/anktsrkr" target="_blank" rel="noopener" title="GitHub">
    
      <i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.linkedin.com/in/ankit-sarkar/" target="_blank" rel="noopener" title="Linkedin">
    
      <i class="sidebar-button-icon fab fa-lg fa-linkedin" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Linkedin</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/ankt_srkr" target="_blank" rel="noopener" title="Twitter">
    
      <i class="sidebar-button-icon fab fa-lg fa-twitter" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://anktsrkr.github.io/index.xml" title="RSS">
    
      <i class="sidebar-button-icon fas fa-lg fa-rss" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="5"
        class="
               hasCoverMetaIn
               ">
        <article class="post" id="top">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title">
      Connect privately to Azure PaaS resources using Azure Private Endpoint from on-prem
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2020-09-15T01:00:00&#43;05:30">
        
  September 15, 2020

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="https://anktsrkr.github.io/categories/hub-spoke-topology">Hub-Spoke Topology</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <p>Hi Everyone!</p>
<p>In this post we are are going to explore different ways to connect Azure PaaS resources from On-premise network privately and securely. While deploying Azure PaaS service such as Azure SQL, Azure Storage etc. it always come with public facing endpoint many customer was not happy with that because of security concerns. So Microsoft introduces <code>Virtual Network Service Endpoints</code>. This will allow customers to secure and direct connectivity to Azure services over an optimized route over the Azure backbone network. Endpoints allow you to secure your Azure resources to only your virtual networks and also it enables private IP addresses in the VNet to reach the endpoint of an Azure service without needing a public IP address on the VNet but technically Azure resources still has a Public IP - it’s just a redirection of traffic.</p>
<p>Service Endpoint needs to be enable at <code>Subnet</code> level and for specific azure service, which means any resource which are in same subnet can be connected, this is security risk. One way to mitigate is to create subnet for each resource which may not be idea scenario and not feasible for enterprise. Other way to mitigate the same issue by using <code>Service Endpoint Policy</code> to filter virtual network traffic to specific Azure resources, over service endpoints.</p>
<p>So, I believe you got the idea that <code>Service Endpoint</code> is defintly a way to communicate over azure backbone but this is not the best solution. So, Microsoft Azure came up with a concept of <code>Azure Private Endpoint</code>.</p>
<h4 id="what-is-private-endpoint">What is Private Endpoint?</h4>
<blockquote>
<p>Azure Private Endpoint is a network interface that connects you privately and securely to a service powered by Azure Private Link. Private Endpoint uses a private IP address from your VNet, effectively bringing the service into your VNet. The service could be an Azure service such as Azure Storage, Azure Cosmos DB, SQL, etc.<!-- raw HTML omitted --><sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup><!-- raw HTML omitted --></p>
</blockquote>
<p>In this case Traffic between your virtual network and the azure resource travels the Microsoft backbone network. Exposing resources to the public internet is no longer necessary.</p>
<p>Now let&rsquo;s setup a Private Endpoint for Azure Blob Storage and see how traffic follows over private ip between on-prem and spokes. I will assume you already have DNS forwarder in Azure and knows about Azure DNS Private Zone and you have hub spokes vnet setup and connected with on-prem network. If you are not sure about all of this I will suggest to go though my previous <a href="https://anktsrkr.github.io/categories/hub-spoke-topology/">posts</a></p>
<p>First we are going to create a <code>subnet</code> where all of our private endpoints will reside. I prefer to keep private endpoint to keep in a separate subnet but it is up to you where you want to keep that. Also my personal choice is to keep shared services private endpoints in <code>hub-vnet</code> and application specific private endpoints in <code>spoke-vnet</code>.
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#75715e">#create subnet for hub</span>
</span></span><span style="display:flex;"><span>$hubvnetName = <span style="color:#e6db74">&#34;hub-vnet&#34;</span>
</span></span><span style="display:flex;"><span>$hubpvtlnksubnet = <span style="color:#e6db74">&#34;10.10.29.0/24&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$hubVnet = Get-AzVirtualNetwork `
</span></span><span style="display:flex;"><span>              -Name $hubvnetName
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Add-AzVirtualNetworkSubnetConfig `
</span></span><span style="display:flex;"><span>   -Name <span style="color:#e6db74">&#34;PrivatelinkSubnet&#34;</span> `
</span></span><span style="display:flex;"><span>   -AddressPrefix $hubpvtlnksubnet `
</span></span><span style="display:flex;"><span>   -VirtualNetwork $hubVnet `
</span></span><span style="display:flex;"><span>   -PrivateEndpointNetworkPoliciesFlag <span style="color:#e6db74">&#34;Disabled&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Set-AzVirtualNetwork `
</span></span><span style="display:flex;"><span>   -VirtualNetwork $hubVnet
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#create subnet for spoke1</span>
</span></span><span style="display:flex;"><span>$spoke1vnetName = <span style="color:#e6db74">&#34;spoke1-vnet&#34;</span>
</span></span><span style="display:flex;"><span>$spoke1pvtlnksubnet = <span style="color:#e6db74">&#34;10.20.29.0/24&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$spoke1Vnet = Get-AzVirtualNetwork `
</span></span><span style="display:flex;"><span>              -Name $spoke1vnetName
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Add-AzVirtualNetworkSubnetConfig `
</span></span><span style="display:flex;"><span>   -Name <span style="color:#e6db74">&#34;PrivatelinkSubnet&#34;</span> `
</span></span><span style="display:flex;"><span>   -AddressPrefix $spoke1pvtlnksubnet `
</span></span><span style="display:flex;"><span>   -VirtualNetwork $spoke1Vnet `
</span></span><span style="display:flex;"><span>   -PrivateEndpointNetworkPoliciesFlag <span style="color:#e6db74">&#34;Disabled&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Set-AzVirtualNetwork `
</span></span><span style="display:flex;"><span>   -VirtualNetwork $spoke1Vnet</span></span></code></pre></div>
Next, we are going to create a Azure Blog Storage.
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$LocationName = <span style="color:#e6db74">&#34;centralindia&#34;</span>
</span></span><span style="display:flex;"><span>$ResourceGroupName = <span style="color:#e6db74">&#34;storage-sandbox&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>New-AzStorageAccount -ResourceGroupName $ResourceGroupName `
</span></span><span style="display:flex;"><span>                     -Name <span style="color:#e6db74">&#34;hubstorageindia&#34;</span> `
</span></span><span style="display:flex;"><span>                     -SkuName Standard_LRS `
</span></span><span style="display:flex;"><span>                     -Location $LocationName `
</span></span><span style="display:flex;"><span>                     -Kind BlobStorage `
</span></span><span style="display:flex;"><span>                     -AccessTier Hot `
</span></span><span style="display:flex;"><span>                     -AllowBlobPublicAccess $false `
</span></span><span style="display:flex;"><span>                     -NetworkRuleSet (@{defaultAction=<span style="color:#e6db74">&#34;Deny&#34;</span>;bypass=<span style="color:#e6db74">&#34;None&#34;</span>}) `
</span></span><span style="display:flex;"><span>                     -MinimumTlsVersion TLS1_2</span></span></code></pre></div>
Now, Let&rsquo;s create a private link for this blob storage and I am keeping this storage account in <code>hub-vnet</code>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$blob= Get-AzStorageAccount `
</span></span><span style="display:flex;"><span>          -ResourceGroupName <span style="color:#e6db74">&#34;storage-sandbox&#34;</span> `
</span></span><span style="display:flex;"><span>          -Name <span style="color:#e6db74">&#34;hubstorageindia&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$LocationName = <span style="color:#e6db74">&#34;centralindia&#34;</span>
</span></span><span style="display:flex;"><span>$NetworkResourceGroupName = <span style="color:#e6db74">&#34;network-sandbox&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$virtualNetwork = Get-AzVirtualNetwork `
</span></span><span style="display:flex;"><span>                     -ResourceGroupName $NetworkResourceGroupName `
</span></span><span style="display:flex;"><span>                     -Name <span style="color:#e6db74">&#34;hub-vnet&#34;</span>  
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>$subnet = $virtualNetwork `
</span></span><span style="display:flex;"><span>                | Select-Object -ExpandProperty subnets `
</span></span><span style="display:flex;"><span>                | Where-Object  {$_.Name <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#39;PrivatelinkSubnet&#39;</span>}  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$privateEndpointConnection = New-AzPrivateLinkServiceConnection `
</span></span><span style="display:flex;"><span>                                -Name <span style="color:#e6db74">&#34;BlobPrivatLinkServiceConnection&#34;</span> `
</span></span><span style="display:flex;"><span>                                -PrivateLinkServiceId $blob.Id `
</span></span><span style="display:flex;"><span>                                -GroupId <span style="color:#e6db74">&#34;blob&#34;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>$privateEndpoint = New-AzPrivateEndpoint `
</span></span><span style="display:flex;"><span>                      -ResourceGroupName $NetworkResourceGroupName `
</span></span><span style="display:flex;"><span>                      -Name <span style="color:#e6db74">&#34;hubstorageindia-private-link&#34;</span> `
</span></span><span style="display:flex;"><span>                      -Location $LocationName `
</span></span><span style="display:flex;"><span>                      -Subnet  $subnet `
</span></span><span style="display:flex;"><span>                      -PrivateLinkServiceConnection $privateEndpointConnection</span></span></code></pre></div>
Next step to create a Azure Private DNS zone this will help us to access this storage account using FQDN.
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>$ResourceGroupName = <span style="color:#e6db74">&#34;dns-sandbox&#34;</span>
</span></span><span style="display:flex;"><span>$ZoneName =<span style="color:#e6db74">&#34;privatelink.blob.core.windows.net&#34;</span>
</span></span><span style="display:flex;"><span>$hubVnet = Get-AzVirtualNetwork `
</span></span><span style="display:flex;"><span>              -Name <span style="color:#e6db74">&#34;hub-vnet&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$zone = New-AzPrivateDnsZone `
</span></span><span style="display:flex;"><span>           -ResourceGroupName $ResourceGroupName `
</span></span><span style="display:flex;"><span>           -Name $ZoneName
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$link  = New-AzPrivateDnsVirtualNetworkLink `
</span></span><span style="display:flex;"><span>            -ResourceGroupName $ResourceGroupName `
</span></span><span style="display:flex;"><span>            -ZoneName $ZoneName `
</span></span><span style="display:flex;"><span>            -Name <span style="color:#e6db74">&#34;LinkWithHub&#34;</span> `
</span></span><span style="display:flex;"><span>            -VirtualNetworkId $hubVnet.Id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$config = New-AzPrivateDnsZoneConfig `
</span></span><span style="display:flex;"><span>             -Name $ZoneName `
</span></span><span style="display:flex;"><span>             -PrivateDnsZoneId $zone.ResourceId
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$privateDnsZoneGroup = New-AzPrivateDnsZoneGroup `
</span></span><span style="display:flex;"><span>                          -ResourceGroupName <span style="color:#e6db74">&#34;network-sandbox&#34;</span> `
</span></span><span style="display:flex;"><span>                          -PrivateEndpointName <span style="color:#e6db74">&#34;hubstorageindia-private-link&#34;</span> `
</span></span><span style="display:flex;"><span>                          -name <span style="color:#e6db74">&#34;blob-zone-grp&#34;</span> `
</span></span><span style="display:flex;"><span>                          -PrivateDnsZoneConfig $config</span></span></code></pre></div>
After this step, If you are accessing <code>hubstorageindia.blob.core.windows.net</code> from <code>hub-vnet</code> virtual machine it should be accessible using private ip only, because Azure DNS Private Zone is linked with <code>hub-vnet</code>. But if you try the same from on-premise network or spoke vnets using FQDN that will not work.
To overcome this, you will need DNS forwarder in Azure and all vnets should be pointed to DNS forwarder server. But if you already have on-premise DNS server then you will have to configure Conditional Forwarding to make it work.</p>
<h4 id="limitation">Limitation</h4>
<p>You should know that Network Security Group (NSG) rules and User Defined Routes do not apply to Private Endpoint.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://docs.microsoft.com/en-us/azure/private-link/private-endpoint-overview">What is Azure Private Endpoint?</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

              
              


            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://anktsrkr.github.io/tags/azure/">Azure</a>

  <a class="tag tag--primary tag--small" href="https://anktsrkr.github.io/tags/networking/">Networking</a>

  <a class="tag tag--primary tag--small" href="https://anktsrkr.github.io/tags/azure-private-dns-zone/">Azure Private DNS Zone</a>

  <a class="tag tag--primary tag--small" href="https://anktsrkr.github.io/tags/azure-private-link/">Azure Private link</a>

                  </div>
                
              
            
            
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://anktsrkr.github.io/post/deploy-app-service-environment-v2-in-microsoft-azure/" data-tooltip="Deploy App Service Environment (ASE v2) in Microsoft Azure" aria-label="NEXT: Deploy App Service Environment (ASE v2) in Microsoft Azure">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://anktsrkr.github.io/post/resolve-azure-internal-dns-from-your-on-prem-network/" data-tooltip="Resolve Azure Internal DNS from your on prem network and Spokes vnet" aria-label="PREVIOUS: Resolve Azure Internal DNS from your on prem network and Spokes vnet">
          
              <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://anktsrkr.github.io/post/connect-privately-to-azure-paas-resources-using-azure-private-endpoint/" title="Share on Facebook" aria-label="Share on Facebook">
          <i class="fab fa-facebook-square" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://anktsrkr.github.io/post/connect-privately-to-azure-paas-resources-using-azure-private-endpoint/" title="Share on Twitter" aria-label="Share on Twitter">
          <i class="fab fa-twitter" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/sharing/share-offsite/?url=https://anktsrkr.github.io/post/connect-privately-to-azure-paas-resources-using-azure-private-endpoint/" title="Share on Linkedin" aria-label="Share on Linkedin">
          <i class="fab fa-linkedin" aria-hidden="true"></i>
        </a>
      </li>
    
  
  
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#disqus_thread" aria-label="Leave a comment">
        <i class="far fa-comment"></i>
      </a>
    </li>
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Back to top">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


            
  
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
    <script type="text/javascript">
      var disqus_config = function() {
        this.page.url = 'https:\/\/anktsrkr.github.io\/post\/connect-privately-to-azure-paas-resources-using-azure-private-endpoint\/';
        
          this.page.identifier = '\/post\/connect-privately-to-azure-paas-resources-using-azure-private-endpoint\/'
        
      };
      (function() {
        
        
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
          document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
          return;
        }
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = 'anktsrkr-github-io';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  


          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2025 Ankit Sarkar | .NET Enthusiast | Azure Cloud Practitioner. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
        
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://anktsrkr.github.io/post/deploy-app-service-environment-v2-in-microsoft-azure/" data-tooltip="Deploy App Service Environment (ASE v2) in Microsoft Azure" aria-label="NEXT: Deploy App Service Environment (ASE v2) in Microsoft Azure">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://anktsrkr.github.io/post/resolve-azure-internal-dns-from-your-on-prem-network/" data-tooltip="Resolve Azure Internal DNS from your on prem network and Spokes vnet" aria-label="PREVIOUS: Resolve Azure Internal DNS from your on prem network and Spokes vnet">
          
              <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://anktsrkr.github.io/post/connect-privately-to-azure-paas-resources-using-azure-private-endpoint/" title="Share on Facebook" aria-label="Share on Facebook">
          <i class="fab fa-facebook-square" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://anktsrkr.github.io/post/connect-privately-to-azure-paas-resources-using-azure-private-endpoint/" title="Share on Twitter" aria-label="Share on Twitter">
          <i class="fab fa-twitter" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/sharing/share-offsite/?url=https://anktsrkr.github.io/post/connect-privately-to-azure-paas-resources-using-azure-private-endpoint/" title="Share on Linkedin" aria-label="Share on Linkedin">
          <i class="fab fa-linkedin" aria-hidden="true"></i>
        </a>
      </li>
    
  
  
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#disqus_thread" aria-label="Leave a comment">
        <i class="far fa-comment"></i>
      </a>
    </li>
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Back to top">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


      </div>
      
<div id="share-options-bar" class="share-options-bar" data-behavior="5">
  <i id="btn-close-shareoptions" class="fa fa-times"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fanktsrkr.github.io%2Fpost%2Fconnect-privately-to-azure-paas-resources-using-azure-private-endpoint%2F" aria-label="Share on Facebook">
          <i class="fab fa-facebook-square" aria-hidden="true"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fanktsrkr.github.io%2Fpost%2Fconnect-privately-to-azure-paas-resources-using-azure-private-endpoint%2F" aria-label="Share on Twitter">
          <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fanktsrkr.github.io%2Fpost%2Fconnect-privately-to-azure-paas-resources-using-azure-private-endpoint%2F" aria-label="Share on Linkedin">
          <i class="fab fa-linkedin" aria-hidden="true"></i><span>Share on Linkedin</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>


    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-times"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.gravatar.com/avatar/95b5dbc23a1aea8bc95d53efd0a30edf?s=110" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Ankit Sarkar | .NET Enthusiast | Azure Cloud Practitioner</h4>
    
      <div id="about-card-bio"><strong>Technical Architect, Microsoft Certified Azure Solutions Architect Expert</strong></div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Technical Architect
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker-alt"></i>
        <br/>
        Leeds
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://anktsrkr.github.io/images/cover.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/powershell.min.js"  crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://anktsrkr.github.io/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js"></script>


  
    <script async crossorigin="anonymous" defer integrity="sha512-gE8KAQyFIzV1C9+GZ8TKJHZS2s+n7EjNtC+IMRn1l5+WYJTHOODUM6JSjZhFhqXmc7bG8Av6XXpckA4tYhflnw==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/apache.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-EWROca+bote+7Oaaar1F6y74iZj1r1F9rm/ly7o+/FwJopbBaWtsFDmaKoZDd3QiGU2pGacBirHJNivmGLYrow==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/go.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-GDVzAn0wpx1yVtQsRWmFc6PhJiLBPdUic+h4GWgljBh904O3JU10fk9EKNpVyIoPqkFn54rgL2QBG4BmUTMpiQ==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/http.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-UgZlma8NzkrDb/NWgmLIcTrH7i/CSnLLDRFqCSNF5NGPpjKmzyM25qcoXGOup8+cDakKyaiTDd7N4dyH4YT+IA==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/less.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-lot9koe73sfXIrUvIPM/UEhuMciN56RPyBdOyZgfO53P2lkWyyXN7J+njcxIIBRV+nVDQeiWtiXg+bLAJZDTfg==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/nginx.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-Zd3e7XxHP00TD0Imr0PIfeM0fl0v95kMWuhyAS3Wn1UTSXTkz0OhtRgBAr4JlmADRgiXr4x7lpeUdqaGN8xIog==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/puppet.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-qtqDO052iXMSP+5d/aE/jMtL9vIIGvONgTJziC2K/ZIB1yEGa55WVxGE9/08rSQ62EoDifS9SWVGZ7ihSLhzMA==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/scss.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-1NmkjnEDnwwwcu28KoQF8vs3oaPFokQHbmbtwGhFfeDsQZtVFI8zW2aE9O8yMYdpdyKV/5blE4pSWw4Z/Sv97w==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/stylus.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-B2wSfruPjr8EJL6IIzQr1eAuDwrsfIfccNf/LCEdxELCgC/S/ZMt/Uvk80aD79m7IqOqW+Sw8nbkvha20yZpzg==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/swift.min.js"></script>
  

  
    <script async crossorigin="anonymous" defer integrity="sha512-28oDiQZGKUVN6wQ7PSLPNipOcmkCALXKwOi7bnkyFf8QiMZQxG9EQoy/iiNx6Zxj2cG2SbVa4dXKigQhu7GiFw==" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/languages/yaml.min.js"></script>
  


<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightElement(block);
  });
});
</script>






<script>
    (function(w,d, s, id) {if(typeof(w.webpushr)!=='undefined') return;w.webpushr=w.webpushr||function(){(w.webpushr.q=w.webpushr.q||[]).push(arguments)};var js, fjs = d.getElementsByTagName(s)[0];js = d.createElement(s); js.id = id;js.async=1;js.src = "https://cdn.webpushr.com/app.min.js";fjs.parentNode.appendChild(js);}(window,document, 'script', 'webpushr-jssdk'));webpushr('setup',{'key':'BEW0OG9D298JEOxVSTObrPp5nebohoFilULY8fRTJ4T-B8KfYk3G9nUAjtbqrX73vsvtkjGXfZNfsLWFz0xNew0' });
   </script>
   
   

<script>
    if('serviceWorker' in navigator) {
        navigator.serviceWorker
            .register('/sw.js', { scope: '/' })
            .then(function(registration) {
            });
  
        navigator.serviceWorker
            .ready
            .then(function(registration) {
            });
    }
  </script>
  
<script id="setmore_script" type="text/javascript" src="https://my.setmore.com/webapp/js/src/others/setmore_iframe.js">
</script>

<a id="Setmore_button_iframe" style="position: fixed;
 right: 20px;
 bottom: 15px;
 z-index: 9998;text-decoration: none"
    href="https://booking.setmore.com/scheduleappointment/d3cbc8af-7bd5-44c1-874b-87c9d77d82be">
    <div style="background: rgb(0, 105, 255); color: rgb(255, 255, 255);
display: table-cell;
width: auto;
height: 45px;
padding: 0 30px;
border-radius: 25px;
box-shadow: rgb(0 0 0 / 25%) 0 2px 5px;
font-family: sans-serif;
text-align: center;
vertical-align: middle;
font-weight: bold;
font-size: 14px;
color: #fff;
cursor: pointer;">#TalkWithMe</div>
</a>

    
  </body>
</html>

